!function(e){var a,o;function s(){s.super_.apply(this,arguments),a(a.proxy(this.init_page,this))}new(a=e,o=+peepsodata.members_hide_before_search,peepso.npm.inherits(s,PsPageAutoload),peepso.npm.objectAssign(s.prototype,{onDocumentLoaded:function(){this._search_$ct=a(this._css_prefix).eq(0),this._search_$trigger=a(this._css_prefix+"-triggerscroll"),this._search_$loading=a(this._css_prefix+"-loading"),this._search_$nomore=a(peepsodata.activity.template_no_more).hide().insertBefore(this._search_$trigger)},init_page:function(){this._search_$query=a(".ps-js-members-query").on("input",a.proxy(this._filter,this)),this._search_$gender=a(".ps-js-members-gender").on("change",a.proxy(this._filter,this)),this._search_$sortby=a(".ps-js-members-sortby").on("change",a.proxy(this._filter,this)),this._search_$avatar=a(".ps-js-members-avatar").on("click",a.proxy(this._filter,this)),this._search_$following=a(".ps-js-members-following").on("change",a.proxy(this._filter,this)),this._search_$extended=a(".ps-js-filter-extended").find("input[type=radio], select"),this._search_$extended.prop("oninput",""),this._search_$extended.filter("select").addClass("ps-select").on("change",a.proxy(this._filter,this)),this._search_$extended.filter("input[type=radio]").on("click",a.proxy(function(e){var s=a(e.target);s.data("ps-checked")?(s.removeData("ps-checked"),s[0].checked=!1):s.data("ps-checked",1),this._filter()},this)),a(".ps-form-search-opt").on("click",a.proxy(this._toggle,this)),this._filter()},_search_url:"membersearch.search",_search_params:{uid:peepsodata.currentuserid,user_id:peepsodata.userid,query:void 0,order_by:void 0,order:void 0,peepso_gender:void 0,peepso_avatar:void 0,peepso_following:void 0,limit:2,page:1},_search_render_html:function(e){return e.members&&e.members.length?e.members.join(""):""},_search_get_items:function(){return this._search_$ct.children(".ps-members-item-wrapper")},_fetch:function(e){return a.Deferred(a.proxy(function(s){e=a.extend({},e),_.isUndefined(e.limit)||(e.limit*=2),this._fetch_xhr&&this._fetch_xhr.abort(),this._fetch_xhr=peepso.disableAuth().disableError().getJson(this._search_url,e,a.proxy(function(e){e.success?s.resolveWith(this,[e.data]):s.rejectWith(this,[e.errors])},this))},this))},_filter:function(){var e=a.trim(this._search_$query.val()),s=this._search_$sortby.val().split("|"),t=this._search_$gender.val(),r=this._search_$avatar[0].checked?1:0,i=this._search_$following[0].value,h={};if(this._fetch_xhr&&this._fetch_xhr.abort(),o&&!e)return clearTimeout(this._search_debounced_timer),this._search_toggle_autoscroll("off"),this._search_toggle_loading("hide"),this._search_$ct.empty(),void this._search_$nomore.hide();this._search_params.query=e||void 0,this._search_params.order_by=s[0]||void 0,this._search_params.order=s[1]||void 0,this._search_params.peepso_gender=t||void 0,this._search_params.peepso_avatar=r||void 0,this._search_params.peepso_following=i||void 0,this._search_params.page=1,"peepso_last_activity"===this._search_params.order_by?this._search_params.limit=25:this._search_params.limit=2,this._search_$extended.each(function(){var e=a(this);"SELECT"===e[0].tagName?h[this.name]=this.value:"radio"===e.attr("type")&&(void 0===h[this.name]&&(h[this.name]=void 0),e[0].checked&&(h[this.name]=this.value))}),_.extend(this._search_params,h),this._search()},_toggle:function(){a(".ps-js-page-filters").stop().slideToggle()}}),s)(".ps-js-members")}(jQuery);