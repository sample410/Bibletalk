!function n(r,d,a){function h(t,o){if(!d[t]){if(!r[t]){var e="function"==typeof require&&require;if(!o&&e)return e(t,!0);if(c)return c(t,!0);var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}var i=d[t]={exports:{}};r[t][0].call(i.exports,function(o){return h(r[t][1][o]||o)},i,i.exports,n,r,d,a)}return d[t].exports}for(var c="function"==typeof require&&require,o=0;o<a.length;o++)h(a[o]);return h}({1:[function(o,t,e){"use strict";var n,s,i;function r(){this.$postbox=null,this.$mood=null,this.$mood_remove=null,this.$mood_dropdown_toggle=null,this.mood_selected=!1,this.can_submit=!1}n=jQuery,s=function(n){var e=n("#mood-text-string").text(),r=false,t=".ps-postbox-moods";function o(){this.__constructor.apply(this,arguments)}return o.prototype={__constructor:function(o){this.postbox=o,this.$doc=n(document),this.$toggle=o.$tabContext.find("#mood-tab"),this.$dropdown=o.$tabContext.find(".ps-js-postbox-mood"),this.$remove=this.$dropdown.find("button"),this.$toggle.on("click"+t,n.proxy(this.toggle,this)),this.$dropdown.on("click"+t,".mood-list",n.proxy(this.select,this)),this.$remove.on("click"+t,n.proxy(this.remove,this)),this._mapMoods(),o.addAction("update",this.update,10,2,this),o.addFilter("render_addons",this.render,10,1,this),o.addFilter("data",this.filterData,10,1,this),o.addFilter("data_validate",this.validate,10,2,this)},show:function(){this.$dropdown.show(),this.$doc.on("click"+t,n.proxy(this.onDocumentClick,this))},hide:function(){this.$dropdown.hide(),this.$doc.off("click"+t)},toggle:function(){this.$dropdown.is(":visible")?this.hide():this.show()},filterData:function(o){return this._selected?o.mood=this._selected.value:o.mood="",o},validate:function(o){return!!this._selected||o},select:function(o){var t=n(o.currentTarget);t.length&&(this._selected={value:t.data("option-value"),label:t.data("option-display-value"),className:t.find("i").attr("class")},this.$toggle.addClass("active"),this.$remove.show(),this.postbox.doAction("refresh"))},remove:function(){this._selected=!1,this.$toggle.removeClass("active"),this.$remove.hide(),this.postbox.doAction("refresh")},update:function(o){(o=o&&o.data||{}).mood?(this._selected={value:o.mood,label:r[o.mood].label,className:r[o.mood].icon},this.$toggle.addClass("active"),this.$remove.show()):(this._selected=!1,this.$toggle.removeClass("active"),this.$remove.hide()),this.postbox.doAction("refresh")},render:function(o){var t;return this._selected&&(t='<i class="'+this._selected.className+'"></i>',t+="<b> "+e+this._selected.label+"</b>",o.push(t)),o},_mapMoods:function(){r||this.$dropdown.find("a.mood-list").each(function(){var o=n(this),t=o.find("i"),e=o.data("option-value"),s=o.data("option-display-value"),i=t.attr("class");(r=r||{})[e]={icon:i,label:s}})},onDocumentClick:function(o){n(o.target).closest(this.$toggle).length||this.hide()}},o}(n),peepso.observer.addAction("postbox_init",function(o){new s(o)},10,1),peepso.observer.addFilter("human_friendly_extras",function(o,t,e){if(!t&&e){var s=n(e).find(".ps-stream-meta .ps-post__mood");if(s.length){var i=function(o){o=o.split(" ");for(var t=0;t<o.length;t++)o[t]=o[t][0].toUpperCase()+o[t].slice(1);return o.join(" ")}(s.text().trim());o.push(i)}}return o},10,3),jQuery||$,i=peepso,r.prototype.set_postbox=function(o){this.$postbox=o},r.prototype.init=function(){if(!_.isUndefined(this.$postbox)){var s=this;i.observer.addFilter("peepso_postbox_can_submit",function(o){return o.soft.push(s.can_submit),o},20,1),this.$mood=jQuery("#postbox-mood",this.$postbox),this.$mood_dropdown_toggle=jQuery("#mood-tab .interaction-icon-wrapper > a",this.$postbox),this.$mood_remove=jQuery("#postbox-mood-remove",this.$postbox),this.$mood.on("click","a.mood-list",function(o){s.select_mood(o)}),this.$mood_remove.on("click",function(){s.remove_mood()}),this.$mood_dropdown_toggle.on("click",function(){s.$mood.toggle()}),this.$mood_dropdown_toggle.on("peepso.interaction-hide",function(){s.$mood.hide()}),jQuery(document).on("click",function(o){var t=jQuery("#mood-tab",s.$postbox);t.is(o.target)||0!==t.has(o.target).length||s.$mood.hide()}),this.$postbox.on("postbox.post_cancel postbox.post_saved",function(){s.remove_mood()}),i.observer.addFilter("postbox_req_"+this.$postbox.guid,function(o){return s.set_mood(o)},10,1),i.observer.addFilter("peepso_postbox_addons_update",function(o){var t,e;return s.mood_selected&&(e='<i class="ps-emoticon '+(t=s.mood_selected)[0]+'"></i> <b>'+t[1]+"</b>",o.push(e)),o},10,1)}},r.prototype.select_mood=function(o){var t=jQuery(o.target).closest("a"),e=jQuery("#mood-tab",this.$postbox),s=jQuery("#postbox-mood-input",this.$postbox),i=(e.find("a"),t.closest("#postbox-mood")),n=(this.$postbox.$textarea.parent(),t.find("i").attr("class")),r=jQuery("#mood-text-string").text()+t.attr("data-option-display-value");s.val(t.attr("data-option-value")),this.$mood_remove.show(),i.hide(),e.addClass("active"),this.mood_selected=[n,r],this.can_submit=!0,this.$postbox.on_change()},r.prototype.remove_mood=function(){jQuery("span#postmood",this.$postbox.$textarea.parent()).remove(),jQuery("#postbox-mood-input",this.$postbox).val(""),jQuery("#mood-tab",this.$postbox).removeClass("active"),this.$mood_remove.hide(),this.$mood.hide(),this.mood_selected=!1,this.can_submit=!1,this.$postbox.on_change()},r.prototype.set_mood=function(o){return void 0===o.mood&&(o.mood=""),o.mood=jQuery("#postbox-mood-input",this.$postbox).val(),o},i.observer.addFilter("peepso_postbox_addons",function(o){return o.push(new r),o},10,1)},{}]},{},[1]);