function PsModalComments(){this.current_object=null,this.objects={}}var ps_comments=new PsModalComments;PsModalComments.prototype.init=function(){peepso.observer.addAction("peepso_delete_post",function(e){peepso.lightbox("close")},10,1)},PsModalComments.prototype.open=function(e,t,s,o){var n=jQuery.extend({object_id:e,type:t},o||{});return peepso.lightbox(function(o){peepso.disableAuth().postJson("modalcomments.get_object",n,function(e){var t=[];s=s||{},e.success&&(t=e.data.objects,s=jQuery.extend({index:e.data.index,afterchange:function(e){jQuery(document).trigger("peepso_tags_init_comments"),activity.setup_comment_textarea(),peepso.observer.applyFilters("modalcomments.afterchange",e),e.$object&&peepso.observer.applyFilters("peepso_activity",e.$object),e.$attachment&&(peepso.observer.applyFilters("peepso_activity",e.$attachment),e.$attachment.find(".ps-stream-attachment, .ps-comment-item").each(function(e){var t=jQuery(this),o=t.html();o=peepso.observer.applyFilters("peepso_activity_content",o),t.html(o)}))}},s)),o(t,s)})}),!1},PsModalComments.prototype.next=function(){this.save_object()},PsModalComments.prototype.prev=function(){this.save_object()},PsModalComments.prototype.save_object=function(){void 0!==this.current_object&&(this.objects[this.current_object.ID]=this.current_object)},jQuery(document).ready(function(){ps_comments.init()});